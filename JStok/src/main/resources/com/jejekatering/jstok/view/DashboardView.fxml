<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.LineChart?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import org.kordamp.ikonli.javafx.FontIcon?>

<StackPane fx:id="rootStack" styleClass="root"
           xmlns:fx="http://javafx.com/fxml"
           fx:controller="com.jejekatering.jstok.controller.DashboardController"
           stylesheets="@../css/style.css"
           prefHeight="850.0" prefWidth="1300.0">

    <HBox spacing="24" style="-fx-padding: 24;">

        <VBox styleClass="sidebar-card" prefWidth="260" spacing="8">
            <HBox alignment="CENTER_LEFT" spacing="12" style="-fx-padding: 8 12 24 12;">
                <StackPane styleClass="brand-icon-container">
                    <FontIcon iconLiteral="fth-package" iconSize="20" iconColor="white"/>
                </StackPane>
                <VBox spacing="2">
                    <Label text="J Stok" styleClass="brand-title"/>
                    <Label text="Inventory System" styleClass="brand-subtitle"/>
                </VBox>
            </HBox>

            <Label text="MENU" styleClass="nav-section-label"/>

            <Button fx:id="btnDashboard" text="Dashboard" onAction="#onMenuDashboardClick" styleClass="nav-button" maxWidth="Infinity">
                <graphic><FontIcon iconLiteral="fth-grid" iconSize="16"/></graphic>
            </Button>
            <Button fx:id="btnBahan" text="Data Bahan" onAction="#onMenuBahanClick" styleClass="nav-button" maxWidth="Infinity">
                <graphic><FontIcon iconLiteral="fth-database" iconSize="16"/></graphic>
            </Button>
            <Button fx:id="btnStokMasuk" text="Stok Masuk" onAction="#onMenuStokMasukClick" styleClass="nav-button" maxWidth="Infinity">
                <graphic><FontIcon iconLiteral="fth-download" iconSize="16"/></graphic>
            </Button>
            <Button fx:id="btnStokKeluar" text="Stok Keluar" onAction="#onMenuStokKeluarClick" styleClass="nav-button" maxWidth="Infinity">
                <graphic><FontIcon iconLiteral="fth-upload" iconSize="16"/></graphic>
            </Button>
            <Button fx:id="btnLaporan" text="Laporan" onAction="#onMenuLaporanClick" styleClass="nav-button" maxWidth="Infinity">
                <graphic><FontIcon iconLiteral="fth-file-text" iconSize="16"/></graphic>
            </Button>

            <Region VBox.vgrow="ALWAYS"/>

            <StackPane styleClass="theme-toggle-sidebar" onMouseClicked="#onToggleTheme">
                <HBox alignment="CENTER" spacing="10">
                    <FontIcon fx:id="themeToggleIcon" iconLiteral="fth-moon" iconSize="16"/>
                    <Label fx:id="themeLabel" text="Dark Mode" styleClass="theme-label"/>
                </HBox>
            </StackPane>

            <Button text="Keluar" onAction="#onLogoutClick" styleClass="nav-button-logout" maxWidth="Infinity">
                <graphic><FontIcon iconLiteral="fth-log-out" iconSize="16" iconColor="#FF3B30"/></graphic>
            </Button>
        </VBox>

        <BorderPane HBox.hgrow="ALWAYS" fx:id="mainBorderPane">
            <center>
                <ScrollPane fx:id="dashboardContent" fitToWidth="true" fitToHeight="true" styleClass="content-scroll" hbarPolicy="NEVER" vbarPolicy="AS_NEEDED">
                    <VBox spacing="24" style="-fx-padding: 8 8 24 8;">

                        <HBox alignment="CENTER_LEFT" spacing="20">
                            <VBox spacing="4">
                                <Label text="Dashboard" styleClass="page-title"/>
                                <Label text="Kesehatan stok &amp; performa inventaris Anda" styleClass="text-secondary"/>
                            </VBox>
                            <Region HBox.hgrow="ALWAYS"/>

                            <Button text="Cek Stok Minimum" styleClass="button-secondary" onAction="#onCekStokMinimumClick">
                                <graphic><FontIcon iconLiteral="fth-alert-circle" iconSize="14"/></graphic>
                            </Button>
                        </HBox>


                        <HBox fx:id="statusIndicatorSection" spacing="16" alignment="CENTER_LEFT" styleClass="status-indicator-bar">
                            <Label text="Status Stok:" styleClass="status-bar-label"/>

                            <HBox spacing="8" alignment="CENTER_LEFT" styleClass="status-badge,status-badge-normal">
                                <StackPane styleClass="status-dot-normal"/>
                                <Label fx:id="lblStokNormal" text="0" styleClass="status-count-normal"/>
                                <Label text="Normal" styleClass="status-label"/>
                            </HBox>

                            <HBox spacing="8" alignment="CENTER_LEFT" styleClass="status-badge,status-badge-warning">
                                <StackPane styleClass="status-dot-warning"/>
                                <Label fx:id="lblStokRendah" text="0" styleClass="status-count-warning"/>
                                <Label text="Rendah" styleClass="status-label"/>
                            </HBox>

                            <HBox spacing="8" alignment="CENTER_LEFT" styleClass="status-badge,status-badge-danger">
                                <StackPane styleClass="status-dot-danger"/>
                                <Label fx:id="lblStokHabis" text="0" styleClass="status-count-danger"/>
                                <Label text="Habis" styleClass="status-label"/>
                            </HBox>
                        </HBox>


                        <GridPane hgap="20" vgap="20">
                            <columnConstraints>
                                <ColumnConstraints percentWidth="25"/>
                                <ColumnConstraints percentWidth="25"/>
                                <ColumnConstraints percentWidth="25"/>
                                <ColumnConstraints percentWidth="25"/>
                            </columnConstraints>

                            <VBox fx:id="card1" styleClass="metric-card-colored,metric-card-red" GridPane.columnIndex="0" spacing="8">
                                <HBox alignment="CENTER_LEFT" spacing="12">
                                    <StackPane styleClass="metric-icon-white">
                                        <FontIcon iconLiteral="fth-alert-triangle" iconSize="20" iconColor="#DC2626"/>
                                    </StackPane>
                                    <Label text="Stok Kritis" styleClass="metric-title-light"/>
                                </HBox>
                                <Label fx:id="lblStokKritisValue" text="0" styleClass="metric-value-light"/>
                                <Label fx:id="lblStokKritisDesc" text="Item perlu restock" styleClass="metric-desc-light"/>
                            </VBox>

                            <VBox fx:id="card2" styleClass="metric-card-colored,metric-card-slate" GridPane.columnIndex="1" spacing="8">
                                <HBox alignment="CENTER_LEFT" spacing="12">
                                    <StackPane styleClass="metric-icon-white">
                                        <FontIcon iconLiteral="fth-archive" iconSize="20" iconColor="#475569"/>
                                    </StackPane>
                                    <Label text="Stok Mati" styleClass="metric-title-light"/>
                                </HBox>
                                <Label fx:id="lblDeadStockValue" text="0" styleClass="metric-value-light"/>
                                <Label fx:id="lblDeadStockDesc" text="Tidak ada keluar 90 hari" styleClass="metric-desc-light"/>
                            </VBox>


                            <VBox fx:id="card3" styleClass="metric-card-colored,metric-card-purple" GridPane.columnIndex="2" spacing="8">
                                <HBox alignment="CENTER_LEFT" spacing="12">
                                    <StackPane styleClass="metric-icon-white">
                                        <FontIcon iconLiteral="fth-activity" iconSize="20" iconColor="#7C3AED"/>
                                    </StackPane>
                                    <Label text="Intensitas Hari Ini" styleClass="metric-title-light"/>
                                </HBox>
                                <Label fx:id="lblTransaksiHariIniValue" text="0" styleClass="metric-value-light"/>
                                <Label fx:id="lblTransaksiHariIniDesc" text="Transaksi hari ini" styleClass="metric-desc-light"/>
                            </VBox>


                            <VBox fx:id="card4" styleClass="metric-card-colored,metric-card-green" GridPane.columnIndex="3" spacing="8">
                                <HBox alignment="CENTER_LEFT" spacing="12">
                                    <StackPane styleClass="metric-icon-white">
                                        <FontIcon iconLiteral="fth-box" iconSize="20" iconColor="#22C55E"/>
                                    </StackPane>
                                    <Label text="Total SKU Aktif" styleClass="metric-title-light"/>
                                </HBox>
                                <Label fx:id="lblTotalSKUValue" text="0" styleClass="metric-value-light"/>
                                <Label fx:id="lblTotalSKUDesc" text="Jenis barang terdaftar" styleClass="metric-desc-light"/>
                            </VBox>
                        </GridPane>

                        <VBox fx:id="chartSection" styleClass="spatial-card" spacing="16">
                            <HBox alignment="CENTER_LEFT" spacing="12">
                                <Label text="Pergerakan Stok (7 Hari Terakhir)" styleClass="section-title"/>
                                <Region HBox.hgrow="ALWAYS"/>
                            </HBox>
                            <LineChart fx:id="lineChart" legendVisible="true" verticalGridLinesVisible="false" minHeight="300" createSymbols="true">
                                <xAxis><CategoryAxis label="Tanggal" fx:id="xAxis"/></xAxis>
                                <yAxis><NumberAxis label="Rasio Stok (%)" fx:id="yAxis"/></yAxis>
                            </LineChart>
                        </VBox>

                        <GridPane hgap="20" vgap="20">
                            <columnConstraints>
                                <ColumnConstraints percentWidth="65"/>
                                <ColumnConstraints percentWidth="35"/>
                            </columnConstraints>

                            <VBox fx:id="restockSection" styleClass="spatial-card" GridPane.columnIndex="0" spacing="16">
                                <HBox alignment="CENTER_LEFT" spacing="12">
                                    <FontIcon iconLiteral="fth-alert-circle" iconSize="18" iconColor="#FF9500"/>
                                    <Label text="Segera Restock" styleClass="section-title"/>
                                    <Region HBox.hgrow="ALWAYS"/>
                                    <Button text="+ Input Masuk" styleClass="button-primary-small" onAction="#onInputMasukClick"/>
                                </HBox>
                                <TableView fx:id="tblRestock" styleClass="modern-table" VBox.vgrow="ALWAYS" minHeight="200">
                                    <columns>
                                        <TableColumn fx:id="colNamaBahan" text="Nama Bahan" prefWidth="160"/>
                                        <TableColumn fx:id="colSisaStok" text="Sisa Stok" prefWidth="80"/>
                                        <TableColumn fx:id="colMinStok" text="Min. Stok" prefWidth="80"/>
                                        <TableColumn fx:id="colSatuan" text="Satuan" prefWidth="70"/>
                                        <TableColumn fx:id="colStatus" text="Status" prefWidth="90"/>
                                    </columns>
                                    <placeholder>
                                        <Label text="Semua stok dalam kondisi aman" styleClass="text-secondary"/>
                                    </placeholder>
                                </TableView>
                            </VBox>

                            <VBox fx:id="fastMovingSection" styleClass="spatial-card" GridPane.columnIndex="1" spacing="16">
                                <HBox alignment="CENTER_LEFT" spacing="12">
                                    <FontIcon iconLiteral="fth-trending-up" iconSize="18" iconColor="#34C759"/>
                                    <Label text="Fast Moving (30 Hari)" styleClass="section-title"/>
                                </HBox>
                                <VBox fx:id="fastMovingList" spacing="8" VBox.vgrow="ALWAYS">
                                    <!-- Dynamic content loaded by controller -->
                                </VBox>
                            </VBox>
                        </GridPane>
                    </VBox>
                </ScrollPane>
            </center>
        </BorderPane>
    </HBox>
</StackPane>



